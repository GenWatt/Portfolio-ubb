import{r as oe,_ as ba}from"./index-El8fevBn.js";import{M as mr,ai as Ta,S as _r,z as Ra,R as Ca,aj as Nr,ak as Se,al as Ue,am as Ge,r as Ce,aa as Pe,an as je,ao as Aa,a5 as Be,ap as Or,X as Fa,P as Dr,W as Br,aq as lr,ar as xa,as as Ua,at as dr,au as Na,av as Oa,aw as Da,ax as Ba,ay as pr,j as ka,F as sr,L as La,az as Ha,aA as Fr,aB as Pa,m as qe,aC as za,a as er,ah as Ga,aD as Za,aE as Wa,aF as $a,aG as Xa,u as Ya,aH as Va,aI as qa,aJ as xr}from"./react-three-fiber.esm-iRFtNYJd.js";var Ee=Uint8Array,ke=Uint16Array,gr=Uint32Array,kr=new Ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Lr=new Ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ka=new Ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Hr=function(i,a){for(var o=new ke(31),c=0;c<31;++c)o[c]=a+=1<<i[c-1];for(var u=new gr(o[30]),c=1;c<30;++c)for(var d=o[c];d<o[c+1];++d)u[d]=d-o[c]<<5|c;return[o,u]},Pr=Hr(kr,2),zr=Pr[0],Ja=Pr[1];zr[28]=258,Ja[258]=28;var Qa=Hr(Lr,0),ja=Qa[0],fr=new ke(32768);for(var ee=0;ee<32768;++ee){var De=(ee&43690)>>>1|(ee&21845)<<1;De=(De&52428)>>>2|(De&13107)<<2,De=(De&61680)>>>4|(De&3855)<<4,fr[ee]=((De&65280)>>>8|(De&255)<<8)>>>1}var Qe=function(i,a,o){for(var c=i.length,u=0,d=new ke(a);u<c;++u)++d[i[u]-1];var v=new ke(a);for(u=0;u<a;++u)v[u]=v[u-1]+d[u-1]<<1;var E;if(o){E=new ke(1<<a);var p=15-a;for(u=0;u<c;++u)if(i[u])for(var y=u<<4|i[u],I=a-i[u],C=v[i[u]-1]++<<I,T=C|(1<<I)-1;C<=T;++C)E[fr[C]>>>p]=y}else for(E=new ke(c),u=0;u<c;++u)i[u]&&(E[u]=fr[v[i[u]-1]++]>>>15-i[u]);return E},rr=new Ee(288);for(var ee=0;ee<144;++ee)rr[ee]=8;for(var ee=144;ee<256;++ee)rr[ee]=9;for(var ee=256;ee<280;++ee)rr[ee]=7;for(var ee=280;ee<288;++ee)rr[ee]=8;var Gr=new Ee(32);for(var ee=0;ee<32;++ee)Gr[ee]=5;var et=Qe(rr,9,1),rt=Qe(Gr,5,1),ur=function(i){for(var a=i[0],o=1;o<i.length;++o)i[o]>a&&(a=i[o]);return a},be=function(i,a,o){var c=a/8|0;return(i[c]|i[c+1]<<8)>>(a&7)&o},hr=function(i,a){var o=a/8|0;return(i[o]|i[o+1]<<8|i[o+2]<<16)>>(a&7)},at=function(i){return(i/8|0)+(i&7&&1)},tt=function(i,a,o){(o==null||o>i.length)&&(o=i.length);var c=new(i instanceof ke?ke:i instanceof gr?gr:Ee)(o-a);return c.set(i.subarray(a,o)),c},nt=function(i,a,o){var c=i.length;if(!c||o&&!o.l&&c<5)return a||new Ee(0);var u=!a||o,d=!o||o.i;o||(o={}),a||(a=new Ee(c*3));var v=function(Y){var Ae=a.length;if(Y>Ae){var Fe=new Ee(Math.max(Ae*2,Y));Fe.set(a),a=Fe}},E=o.f||0,p=o.p||0,y=o.b||0,I=o.l,C=o.d,T=o.m,L=o.n,D=c*8;do{if(!I){o.f=E=be(i,p,1);var X=be(i,p+1,3);if(p+=3,X)if(X==1)I=et,C=rt,T=9,L=5;else if(X==2){var se=be(i,p,31)+257,le=be(i,p+10,15)+4,G=se+be(i,p+5,31)+1;p+=14;for(var H=new Ee(G),re=new Ee(19),S=0;S<le;++S)re[Ka[S]]=be(i,p+S*3,7);p+=le*3;for(var b=ur(re),z=(1<<b)-1,$=Qe(re,b,1),S=0;S<G;){var P=$[be(i,p,z)];p+=P&15;var x=P>>>4;if(x<16)H[S++]=x;else{var Z=0,F=0;for(x==16?(F=3+be(i,p,3),p+=2,Z=H[S-1]):x==17?(F=3+be(i,p,7),p+=3):x==18&&(F=11+be(i,p,127),p+=7);F--;)H[S++]=Z}}var ae=H.subarray(0,se),O=H.subarray(se);T=ur(ae),L=ur(O),I=Qe(ae,T,1),C=Qe(O,L,1)}else throw"invalid block type";else{var x=at(p)+4,B=i[x-4]|i[x-3]<<8,ue=x+B;if(ue>c){if(d)throw"unexpected EOF";break}u&&v(y+B),a.set(i.subarray(x,ue),y),o.b=y+=B,o.p=p=ue*8;continue}if(p>D){if(d)throw"unexpected EOF";break}}u&&v(y+131072);for(var Me=(1<<T)-1,Le=(1<<L)-1,Ie=p;;Ie=p){var Z=I[hr(i,p)&Me],Q=Z>>>4;if(p+=Z&15,p>D){if(d)throw"unexpected EOF";break}if(!Z)throw"invalid length/literal";if(Q<256)a[y++]=Q;else if(Q==256){Ie=p,I=null;break}else{var Ne=Q-254;if(Q>264){var S=Q-257,te=kr[S];Ne=be(i,p,(1<<te)-1)+zr[S],p+=te}var ve=C[hr(i,p)&Le],Te=ve>>>4;if(!ve)throw"invalid distance";p+=ve&15;var O=ja[Te];if(Te>3){var te=Lr[Te];O+=hr(i,p)&(1<<te)-1,p+=te}if(p>D){if(d)throw"unexpected EOF";break}u&&v(y+131072);for(var Ze=y+Ne;y<Ze;y+=4)a[y]=a[y-O],a[y+1]=a[y+1-O],a[y+2]=a[y+2-O],a[y+3]=a[y+3-O];y=Ze}}o.l=I,o.p=Ie,o.b=y,I&&(E=1,o.m=T,o.d=C,o.n=L)}while(!E);return y==a.length?a:tt(a,0,y)},it=new Ee(0),ot=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function nr(i,a){return nt((ot(i),i.subarray(2,-4)),a)}var st=typeof TextDecoder<"u"&&new TextDecoder,lt=0;try{st.decode(it,{stream:!0}),lt=1}catch{}const ct=i=>i&&i.isCubeTexture;class ut extends mr{constructor(a,o){var c,u;const d=ct(a),E=((u=d?(c=a.image[0])==null?void 0:c.width:a.image.width)!=null?u:1024)/4,p=Math.floor(Math.log2(E)),y=Math.pow(2,p),I=3*Math.max(y,16*7),C=4*y,T=[d?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/I}`,`#define CUBEUV_TEXEL_HEIGHT ${1/C}`,`#define CUBEUV_MAX_MIP ${p}.0`],L=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,D=T.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(Ca.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,X={map:{value:a},height:{value:(o==null?void 0:o.height)||15},radius:{value:(o==null?void 0:o.radius)||100}},x=new Ta(1,16),B=new _r({uniforms:X,fragmentShader:D,vertexShader:L,side:Ra});super(x,B)}set radius(a){this.material.uniforms.radius.value=a}get radius(){return this.material.uniforms.radius.value}set height(a){this.material.uniforms.height.value=a}get height(){return this.material.uniforms.height.value}}class ht extends Nr{constructor(a){super(a),this.type=Se}parse(a){const v=function(S,b){switch(S){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(b||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(b||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(b||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(b||""))}},I=`
`,C=function(S,b,z){b=b||1024;let P=S.pos,Z=-1,F=0,ae="",O=String.fromCharCode.apply(null,new Uint16Array(S.subarray(P,P+128)));for(;0>(Z=O.indexOf(I))&&F<b&&P<S.byteLength;)ae+=O,F+=O.length,P+=128,O+=String.fromCharCode.apply(null,new Uint16Array(S.subarray(P,P+128)));return-1<Z?(S.pos+=F+Z+1,ae+O.slice(0,Z)):!1},T=function(S){const b=/^#\?(\S+)/,z=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,$=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,P=/^\s*FORMAT=(\S+)\s*$/,Z=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,F={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ae,O;for((S.pos>=S.byteLength||!(ae=C(S)))&&v(1,"no header found"),(O=ae.match(b))||v(3,"bad initial token"),F.valid|=1,F.programtype=O[1],F.string+=ae+`
`;ae=C(S),ae!==!1;){if(F.string+=ae+`
`,ae.charAt(0)==="#"){F.comments+=ae+`
`;continue}if((O=ae.match(z))&&(F.gamma=parseFloat(O[1])),(O=ae.match($))&&(F.exposure=parseFloat(O[1])),(O=ae.match(P))&&(F.valid|=2,F.format=O[1]),(O=ae.match(Z))&&(F.valid|=4,F.height=parseInt(O[1],10),F.width=parseInt(O[2],10)),F.valid&2&&F.valid&4)break}return F.valid&2||v(3,"missing format specifier"),F.valid&4||v(3,"missing image size specifier"),F},L=function(S,b,z){const $=b;if($<8||$>32767||S[0]!==2||S[1]!==2||S[2]&128)return new Uint8Array(S);$!==(S[2]<<8|S[3])&&v(3,"wrong scanline width");const P=new Uint8Array(4*b*z);P.length||v(4,"unable to allocate buffer space");let Z=0,F=0;const ae=4*$,O=new Uint8Array(4),Me=new Uint8Array(ae);let Le=z;for(;Le>0&&F<S.byteLength;){F+4>S.byteLength&&v(1),O[0]=S[F++],O[1]=S[F++],O[2]=S[F++],O[3]=S[F++],(O[0]!=2||O[1]!=2||(O[2]<<8|O[3])!=$)&&v(3,"bad rgbe scanline format");let Ie=0,Q;for(;Ie<ae&&F<S.byteLength;){Q=S[F++];const te=Q>128;if(te&&(Q-=128),(Q===0||Ie+Q>ae)&&v(3,"bad scanline data"),te){const ve=S[F++];for(let Te=0;Te<Q;Te++)Me[Ie++]=ve}else Me.set(S.subarray(F,F+Q),Ie),Ie+=Q,F+=Q}const Ne=$;for(let te=0;te<Ne;te++){let ve=0;P[Z]=Me[te+ve],ve+=$,P[Z+1]=Me[te+ve],ve+=$,P[Z+2]=Me[te+ve],ve+=$,P[Z+3]=Me[te+ve],Z+=4}Le--}return P},D=function(S,b,z,$){const P=S[b+3],Z=Math.pow(2,P-128)/255;z[$+0]=S[b+0]*Z,z[$+1]=S[b+1]*Z,z[$+2]=S[b+2]*Z,z[$+3]=1},X=function(S,b,z,$){const P=S[b+3],Z=Math.pow(2,P-128)/255;z[$+0]=Ge.toHalfFloat(Math.min(S[b+0]*Z,65504)),z[$+1]=Ge.toHalfFloat(Math.min(S[b+1]*Z,65504)),z[$+2]=Ge.toHalfFloat(Math.min(S[b+2]*Z,65504)),z[$+3]=Ge.toHalfFloat(1)},x=new Uint8Array(a);x.pos=0;const B=T(x),ue=B.width,se=B.height,le=L(x.subarray(x.pos),ue,se);let G,H,re;switch(this.type){case Ue:re=le.length/4;const S=new Float32Array(re*4);for(let z=0;z<re;z++)D(le,z*4,S,z*4);G=S,H=Ue;break;case Se:re=le.length/4;const b=new Uint16Array(re*4);for(let z=0;z<re;z++)X(le,z*4,b,z*4);G=b,H=Se;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:ue,height:se,data:G,header:B.string,gamma:B.gamma,exposure:B.exposure,type:H}}setDataType(a){return this.type=a,this}load(a,o,c,u){function d(v,E){switch(v.type){case Ue:case Se:"colorSpace"in v?v.colorSpace="srgb-linear":v.encoding=3e3,v.minFilter=Ce,v.magFilter=Ce,v.generateMipmaps=!1,v.flipY=!0;break}o&&o(v,E)}return super.load(a,d,c,u)}}const Ke="colorSpace"in new Pe;class vt extends Nr{constructor(a){super(a),this.type=Se}parse(a){const b=Math.pow(2.7182818,2.2);function z(e,r){for(var t=0,n=0;n<65536;++n)(n==0||e[n>>3]&1<<(n&7))&&(r[t++]=n);for(var s=t-1;t<65536;)r[t++]=0;return s}function $(e){for(var r=0;r<16384;r++)e[r]={},e[r].len=0,e[r].lit=0,e[r].p=null}const P={l:0,c:0,lc:0};function Z(e,r,t,n,s){for(;t<e;)r=r<<8|Cr(n,s),t+=8;t-=e,P.l=r>>t&(1<<e)-1,P.c=r,P.lc=t}const F=new Array(59);function ae(e){for(var r=0;r<=58;++r)F[r]=0;for(var r=0;r<65537;++r)F[e[r]]+=1;for(var t=0,r=58;r>0;--r){var n=t+F[r]>>1;F[r]=t,t=n}for(var r=0;r<65537;++r){var s=e[r];s>0&&(e[r]=s|F[s]++<<6)}}function O(e,r,t,n,s,l,g){for(var h=t,_=0,m=0;s<=l;s++){if(h.value-t.value>n)return!1;Z(6,_,m,e,h);var w=P.l;if(_=P.c,m=P.lc,g[s]=w,w==63){if(h.value-t.value>n)throw"Something wrong with hufUnpackEncTable";Z(8,_,m,e,h);var f=P.l+6;if(_=P.c,m=P.lc,s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)g[s++]=0;s--}else if(w>=59){var f=w-59+2;if(s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)g[s++]=0;s--}}ae(g)}function Me(e){return e&63}function Le(e){return e>>6}function Ie(e,r,t,n){for(;r<=t;r++){var s=Le(e[r]),l=Me(e[r]);if(s>>l)throw"Invalid table entry";if(l>14){var g=n[s>>l-14];if(g.len)throw"Invalid table entry";if(g.lit++,g.p){var h=g.p;g.p=new Array(g.lit);for(var _=0;_<g.lit-1;++_)g.p[_]=h[_]}else g.p=new Array(1);g.p[g.lit-1]=r}else if(l)for(var m=0,_=1<<14-l;_>0;_--){var g=n[(s<<14-l)+m];if(g.len||g.p)throw"Invalid table entry";g.len=l,g.lit=r,m++}}return!0}const Q={c:0,lc:0};function Ne(e,r,t,n){e=e<<8|Cr(t,n),r+=8,Q.c=e,Q.lc=r}const te={c:0,lc:0};function ve(e,r,t,n,s,l,g,h,_,m){if(e==r){n<8&&(Ne(t,n,s,g),t=Q.c,n=Q.lc),n-=8;var w=t>>n,w=new Uint8Array([w])[0];if(_.value+w>m)return!1;for(var f=h[_.value-1];w-- >0;)h[_.value++]=f}else if(_.value<m)h[_.value++]=e;else return!1;te.c=t,te.lc=n}function Te(e){return e&65535}function Ze(e){var r=Te(e);return r>32767?r-65536:r}const Y={a:0,b:0};function Ae(e,r){var t=Ze(e),n=Ze(r),s=n,l=t+(s&1)+(s>>1),g=l,h=l-s;Y.a=g,Y.b=h}function Fe(e,r){var t=Te(e),n=Te(r),s=t-(n>>1)&65535,l=n+s-32768&65535;Y.a=l,Y.b=s}function qr(e,r,t,n,s,l,g){for(var h=g<16384,_=t>s?s:t,m=1,w;m<=_;)m<<=1;for(m>>=1,w=m,m>>=1;m>=1;){for(var f=0,ie=f+l*(s-w),R=l*m,A=l*w,U=n*m,N=n*w,V,K,ce,ge;f<=ie;f+=A){for(var J=f,Re=f+n*(t-w);J<=Re;J+=N){var j=J+U,he=J+R,xe=he+U;h?(Ae(e[J+r],e[he+r]),V=Y.a,ce=Y.b,Ae(e[j+r],e[xe+r]),K=Y.a,ge=Y.b,Ae(V,K),e[J+r]=Y.a,e[j+r]=Y.b,Ae(ce,ge),e[he+r]=Y.a,e[xe+r]=Y.b):(Fe(e[J+r],e[he+r]),V=Y.a,ce=Y.b,Fe(e[j+r],e[xe+r]),K=Y.a,ge=Y.b,Fe(V,K),e[J+r]=Y.a,e[j+r]=Y.b,Fe(ce,ge),e[he+r]=Y.a,e[xe+r]=Y.b)}if(t&m){var he=J+R;h?Ae(e[J+r],e[he+r]):Fe(e[J+r],e[he+r]),V=Y.a,e[he+r]=Y.b,e[J+r]=V}}if(s&m)for(var J=f,Re=f+n*(t-w);J<=Re;J+=N){var j=J+U;h?Ae(e[J+r],e[j+r]):Fe(e[J+r],e[j+r]),V=Y.a,e[j+r]=Y.b,e[J+r]=V}w=m,m>>=1}return f}function Kr(e,r,t,n,s,l,g,h,_,m){for(var w=0,f=0,ie=h,R=Math.trunc(s.value+(l+7)/8);s.value<R;)for(Ne(w,f,t,s),w=Q.c,f=Q.lc;f>=14;){var A=w>>f-14&16383,U=r[A];if(U.len)f-=U.len,ve(U.lit,g,w,f,t,n,s,_,m,ie),w=te.c,f=te.lc;else{if(!U.p)throw"hufDecode issues";var N;for(N=0;N<U.lit;N++){for(var V=Me(e[U.p[N]]);f<V&&s.value<R;)Ne(w,f,t,s),w=Q.c,f=Q.lc;if(f>=V&&Le(e[U.p[N]])==(w>>f-V&(1<<V)-1)){f-=V,ve(U.p[N],g,w,f,t,n,s,_,m,ie),w=te.c,f=te.lc;break}}if(N==U.lit)throw"hufDecode issues"}}var K=8-l&7;for(w>>=K,f-=K;f>0;){var U=r[w<<14-f&16383];if(U.len)f-=U.len,ve(U.lit,g,w,f,t,n,s,_,m,ie),w=te.c,f=te.lc;else throw"hufDecode issues"}return!0}function Sr(e,r,t,n,s,l){var g={value:0},h=t.value,_=fe(r,t),m=fe(r,t);t.value+=4;var w=fe(r,t);if(t.value+=4,_<0||_>=65537||m<0||m>=65537)throw"Something wrong with HUF_ENCSIZE";var f=new Array(65537),ie=new Array(16384);$(ie);var R=n-(t.value-h);if(O(e,r,t,R,_,m,f),w>8*(n-(t.value-h)))throw"Something wrong with hufUncompress";Ie(f,_,m,ie),Kr(f,ie,e,r,t,w,m,l,s,g)}function Jr(e,r,t){for(var n=0;n<t;++n)r[n]=e[r[n]]}function Mr(e){for(var r=1;r<e.length;r++){var t=e[r-1]+e[r]-128;e[r]=t}}function Ir(e,r){for(var t=0,n=Math.floor((e.length+1)/2),s=0,l=e.length-1;!(s>l||(r[s++]=e[t++],s>l));)r[s++]=e[n++]}function br(e){for(var r=e.byteLength,t=new Array,n=0,s=new DataView(e);r>0;){var l=s.getInt8(n++);if(l<0){var g=-l;r-=g+1;for(var h=0;h<g;h++)t.push(s.getUint8(n++))}else{var g=l;r-=2;for(var _=s.getUint8(n++),h=0;h<g+1;h++)t.push(_)}}return t}function Qr(e,r,t,n,s,l){var j=new DataView(l.buffer),g=t[e.idx[0]].width,h=t[e.idx[0]].height,_=3,m=Math.floor(g/8),w=Math.ceil(g/8),f=Math.ceil(h/8),ie=g-(w-1)*8,R=h-(f-1)*8,A={value:0},U=new Array(_),N=new Array(_),V=new Array(_),K=new Array(_),ce=new Array(_);for(let q=0;q<_;++q)ce[q]=r[e.idx[q]],U[q]=q<1?0:U[q-1]+w*f,N[q]=new Float32Array(64),V[q]=new Uint16Array(64),K[q]=new Uint16Array(w*64);for(let q=0;q<f;++q){var ge=8;q==f-1&&(ge=R);var J=8;for(let ne=0;ne<w;++ne){ne==w-1&&(J=ie);for(let W=0;W<_;++W)V[W].fill(0),V[W][0]=s[U[W]++],jr(A,n,V[W]),ea(V[W],N[W]),ra(N[W]);aa(N);for(let W=0;W<_;++W)ta(N[W],K[W],ne*64)}let pe=0;for(let ne=0;ne<_;++ne){const W=t[e.idx[ne]].type;for(let ye=8*q;ye<8*q+ge;++ye){pe=ce[ne][ye];for(let He=0;He<m;++He){const me=He*64+(ye&7)*8;j.setUint16(pe+0*2*W,K[ne][me+0],!0),j.setUint16(pe+1*2*W,K[ne][me+1],!0),j.setUint16(pe+2*2*W,K[ne][me+2],!0),j.setUint16(pe+3*2*W,K[ne][me+3],!0),j.setUint16(pe+4*2*W,K[ne][me+4],!0),j.setUint16(pe+5*2*W,K[ne][me+5],!0),j.setUint16(pe+6*2*W,K[ne][me+6],!0),j.setUint16(pe+7*2*W,K[ne][me+7],!0),pe+=8*2*W}}if(m!=w)for(let ye=8*q;ye<8*q+ge;++ye){const He=ce[ne][ye]+8*m*2*W,me=m*64+(ye&7)*8;for(let Oe=0;Oe<J;++Oe)j.setUint16(He+Oe*2*W,K[ne][me+Oe],!0)}}}for(var Re=new Uint16Array(g),j=new DataView(l.buffer),he=0;he<_;++he){t[e.idx[he]].decoded=!0;var xe=t[e.idx[he]].type;if(t[he].type==2)for(var Ve=0;Ve<h;++Ve){const q=ce[he][Ve];for(var we=0;we<g;++we)Re[we]=j.getUint16(q+we*2*xe,!0);for(var we=0;we<g;++we)j.setFloat32(q+we*2*xe,M(Re[we]),!0)}}}function jr(e,r,t){for(var n,s=1;s<64;)n=r[e.value],n==65280?s=64:n>>8==255?s+=n&255:(t[s]=n,s++),e.value++}function ea(e,r){r[0]=M(e[0]),r[1]=M(e[1]),r[2]=M(e[5]),r[3]=M(e[6]),r[4]=M(e[14]),r[5]=M(e[15]),r[6]=M(e[27]),r[7]=M(e[28]),r[8]=M(e[2]),r[9]=M(e[4]),r[10]=M(e[7]),r[11]=M(e[13]),r[12]=M(e[16]),r[13]=M(e[26]),r[14]=M(e[29]),r[15]=M(e[42]),r[16]=M(e[3]),r[17]=M(e[8]),r[18]=M(e[12]),r[19]=M(e[17]),r[20]=M(e[25]),r[21]=M(e[30]),r[22]=M(e[41]),r[23]=M(e[43]),r[24]=M(e[9]),r[25]=M(e[11]),r[26]=M(e[18]),r[27]=M(e[24]),r[28]=M(e[31]),r[29]=M(e[40]),r[30]=M(e[44]),r[31]=M(e[53]),r[32]=M(e[10]),r[33]=M(e[19]),r[34]=M(e[23]),r[35]=M(e[32]),r[36]=M(e[39]),r[37]=M(e[45]),r[38]=M(e[52]),r[39]=M(e[54]),r[40]=M(e[20]),r[41]=M(e[22]),r[42]=M(e[33]),r[43]=M(e[38]),r[44]=M(e[46]),r[45]=M(e[51]),r[46]=M(e[55]),r[47]=M(e[60]),r[48]=M(e[21]),r[49]=M(e[34]),r[50]=M(e[37]),r[51]=M(e[47]),r[52]=M(e[50]),r[53]=M(e[56]),r[54]=M(e[59]),r[55]=M(e[61]),r[56]=M(e[35]),r[57]=M(e[36]),r[58]=M(e[48]),r[59]=M(e[49]),r[60]=M(e[57]),r[61]=M(e[58]),r[62]=M(e[62]),r[63]=M(e[63])}function ra(e){const r=.5*Math.cos(.7853975),t=.5*Math.cos(3.14159/16),n=.5*Math.cos(3.14159/8),s=.5*Math.cos(3*3.14159/16),l=.5*Math.cos(5*3.14159/16),g=.5*Math.cos(3*3.14159/8),h=.5*Math.cos(7*3.14159/16);for(var _=new Array(4),m=new Array(4),w=new Array(4),f=new Array(4),ie=0;ie<8;++ie){var R=ie*8;_[0]=n*e[R+2],_[1]=g*e[R+2],_[2]=n*e[R+6],_[3]=g*e[R+6],m[0]=t*e[R+1]+s*e[R+3]+l*e[R+5]+h*e[R+7],m[1]=s*e[R+1]-h*e[R+3]-t*e[R+5]-l*e[R+7],m[2]=l*e[R+1]-t*e[R+3]+h*e[R+5]+s*e[R+7],m[3]=h*e[R+1]-l*e[R+3]+s*e[R+5]-t*e[R+7],w[0]=r*(e[R+0]+e[R+4]),w[3]=r*(e[R+0]-e[R+4]),w[1]=_[0]+_[3],w[2]=_[1]-_[2],f[0]=w[0]+w[1],f[1]=w[3]+w[2],f[2]=w[3]-w[2],f[3]=w[0]-w[1],e[R+0]=f[0]+m[0],e[R+1]=f[1]+m[1],e[R+2]=f[2]+m[2],e[R+3]=f[3]+m[3],e[R+4]=f[3]-m[3],e[R+5]=f[2]-m[2],e[R+6]=f[1]-m[1],e[R+7]=f[0]-m[0]}for(var A=0;A<8;++A)_[0]=n*e[16+A],_[1]=g*e[16+A],_[2]=n*e[48+A],_[3]=g*e[48+A],m[0]=t*e[8+A]+s*e[24+A]+l*e[40+A]+h*e[56+A],m[1]=s*e[8+A]-h*e[24+A]-t*e[40+A]-l*e[56+A],m[2]=l*e[8+A]-t*e[24+A]+h*e[40+A]+s*e[56+A],m[3]=h*e[8+A]-l*e[24+A]+s*e[40+A]-t*e[56+A],w[0]=r*(e[A]+e[32+A]),w[3]=r*(e[A]-e[32+A]),w[1]=_[0]+_[3],w[2]=_[1]-_[2],f[0]=w[0]+w[1],f[1]=w[3]+w[2],f[2]=w[3]-w[2],f[3]=w[0]-w[1],e[0+A]=f[0]+m[0],e[8+A]=f[1]+m[1],e[16+A]=f[2]+m[2],e[24+A]=f[3]+m[3],e[32+A]=f[3]-m[3],e[40+A]=f[2]-m[2],e[48+A]=f[1]-m[1],e[56+A]=f[0]-m[0]}function aa(e){for(var r=0;r<64;++r){var t=e[0][r],n=e[1][r],s=e[2][r];e[0][r]=t+1.5747*s,e[1][r]=t-.1873*n-.4682*s,e[2][r]=t+1.8556*n}}function ta(e,r,t){for(var n=0;n<64;++n)r[t+n]=Ge.toHalfFloat(na(e[n]))}function na(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(b,Math.abs(e)-1)}function Tr(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function ia(e){var r=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),t=new Uint8Array(br(r)),n=new Uint8Array(t.length);return Mr(t),Ir(t,n),new DataView(n.buffer)}function cr(e){var r=e.array.slice(e.offset.value,e.offset.value+e.size),t=nr(r),n=new Uint8Array(t.length);return Mr(t),Ir(t,n),new DataView(n.buffer)}function oa(e){for(var r=e.viewer,t={value:e.offset.value},n=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),s=new Uint8Array(8192),l=0,g=new Array(e.channels),h=0;h<e.channels;h++)g[h]={},g[h].start=l,g[h].end=g[h].start,g[h].nx=e.width,g[h].ny=e.lines,g[h].size=e.type,l+=g[h].nx*g[h].ny*g[h].size;var _=$e(r,t),m=$e(r,t);if(m>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(_<=m)for(var h=0;h<m-_+1;h++)s[h+_]=ze(r,t);var w=new Uint16Array(65536),f=z(s,w),ie=fe(r,t);Sr(e.array,r,t,ie,n,l);for(var h=0;h<e.channels;++h)for(var R=g[h],A=0;A<g[h].size;++A)qr(n,R.start+A,R.nx,R.size,R.ny,R.nx*R.size,f);Jr(w,n,l);for(var U=0,N=new Uint8Array(n.buffer.byteLength),V=0;V<e.lines;V++)for(var K=0;K<e.channels;K++){var R=g[K],ce=R.nx*R.size,ge=new Uint8Array(n.buffer,R.end*2,ce*2);N.set(ge,U),U+=ce*2,R.end+=ce}return new DataView(N.buffer)}function sa(e){var r=e.array.slice(e.offset.value,e.offset.value+e.size),t=nr(r);const n=e.lines*e.channels*e.width,s=e.type==1?new Uint16Array(n):new Uint32Array(n);let l=0,g=0;const h=new Array(4);for(let _=0;_<e.lines;_++)for(let m=0;m<e.channels;m++){let w=0;switch(e.type){case 1:h[0]=l,h[1]=h[0]+e.width,l=h[1]+e.width;for(let f=0;f<e.width;++f){const ie=t[h[0]++]<<8|t[h[1]++];w+=ie,s[g]=w,g++}break;case 2:h[0]=l,h[1]=h[0]+e.width,h[2]=h[1]+e.width,l=h[2]+e.width;for(let f=0;f<e.width;++f){const ie=t[h[0]++]<<24|t[h[1]++]<<16|t[h[2]++]<<8;w+=ie,s[g]=w,g++}break}}return new DataView(s.buffer)}function Rr(e){var r=e.viewer,t={value:e.offset.value},n=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),s={version:_e(r,t),unknownUncompressedSize:_e(r,t),unknownCompressedSize:_e(r,t),acCompressedSize:_e(r,t),dcCompressedSize:_e(r,t),rleCompressedSize:_e(r,t),rleUncompressedSize:_e(r,t),rleRawSize:_e(r,t),totalAcUncompressedCount:_e(r,t),totalDcUncompressedCount:_e(r,t),acCompression:_e(r,t)};if(s.version<2)throw"EXRLoader.parse: "+Ye.compression+" version "+s.version+" is unsupported";for(var l=new Array,g=$e(r,t)-2;g>0;){var h=ar(r.buffer,t),_=ze(r,t),m=_>>2&3,w=(_>>4)-1,f=new Int8Array([w])[0],ie=ze(r,t);l.push({name:h,index:f,type:ie,compression:m}),g-=h.length+3}for(var R=Ye.channels,A=new Array(e.channels),U=0;U<e.channels;++U){var N=A[U]={},V=R[U];N.name=V.name,N.compression=0,N.decoded=!1,N.type=V.pixelType,N.pLinear=V.pLinear,N.width=e.width,N.height=e.lines}for(var K={idx:new Array(3)},ce=0;ce<e.channels;++ce)for(var N=A[ce],U=0;U<l.length;++U){var ge=l[U];N.name==ge.name&&(N.compression=ge.compression,ge.index>=0&&(K.idx[ge.index]=ce),N.offset=ce)}if(s.acCompressedSize>0)switch(s.acCompression){case 0:var j=new Uint16Array(s.totalAcUncompressedCount);Sr(e.array,r,t,s.acCompressedSize,j,s.totalAcUncompressedCount);break;case 1:var J=e.array.slice(t.value,t.value+s.totalAcUncompressedCount),Re=nr(J),j=new Uint16Array(Re.buffer);t.value+=s.totalAcUncompressedCount;break}if(s.dcCompressedSize>0){var he={array:e.array,offset:t,size:s.dcCompressedSize},xe=new Uint16Array(cr(he).buffer);t.value+=s.dcCompressedSize}if(s.rleRawSize>0){var J=e.array.slice(t.value,t.value+s.rleCompressedSize),Re=nr(J),Ve=br(Re.buffer);t.value+=s.rleCompressedSize}for(var we=0,q=new Array(A.length),U=0;U<q.length;++U)q[U]=new Array;for(var pe=0;pe<e.lines;++pe)for(var ne=0;ne<A.length;++ne)q[ne].push(we),we+=A[ne].width*e.type*2;Qr(K,q,A,j,xe,n);for(var U=0;U<A.length;++U){var N=A[U];if(!N.decoded)switch(N.compression){case 2:for(var W=0,ye=0,pe=0;pe<e.lines;++pe){for(var He=q[U][W],me=0;me<N.width;++me){for(var Oe=0;Oe<2*N.type;++Oe)n[He++]=Ve[ye+Oe*N.width*N.height];ye++}W++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(n.buffer)}function ar(e,r){for(var t=new Uint8Array(e),n=0;t[r.value+n]!=0;)n+=1;var s=new TextDecoder().decode(t.slice(r.value,r.value+n));return r.value=r.value+n+1,s}function la(e,r,t){var n=new TextDecoder().decode(new Uint8Array(e).slice(r.value,r.value+t));return r.value=r.value+t,n}function ca(e,r){var t=We(e,r),n=fe(e,r);return[t,n]}function ua(e,r){var t=fe(e,r),n=fe(e,r);return[t,n]}function We(e,r){var t=e.getInt32(r.value,!0);return r.value=r.value+4,t}function fe(e,r){var t=e.getUint32(r.value,!0);return r.value=r.value+4,t}function Cr(e,r){var t=e[r.value];return r.value=r.value+1,t}function ze(e,r){var t=e.getUint8(r.value);return r.value=r.value+1,t}const _e=function(e,r){let t;return"getBigInt64"in DataView.prototype?t=Number(e.getBigInt64(r.value,!0)):t=e.getUint32(r.value+4,!0)+Number(e.getUint32(r.value,!0)<<32),r.value+=8,t};function de(e,r){var t=e.getFloat32(r.value,!0);return r.value+=4,t}function ha(e,r){return Ge.toHalfFloat(de(e,r))}function M(e){var r=(e&31744)>>10,t=e&1023;return(e>>15?-1:1)*(r?r===31?t?NaN:1/0:Math.pow(2,r-15)*(1+t/1024):6103515625e-14*(t/1024))}function $e(e,r){var t=e.getUint16(r.value,!0);return r.value+=2,t}function va(e,r){return M($e(e,r))}function da(e,r,t,n){for(var s=t.value,l=[];t.value<s+n-1;){var g=ar(r,t),h=We(e,t),_=ze(e,t);t.value+=3;var m=We(e,t),w=We(e,t);l.push({name:g,pixelType:h,pLinear:_,xSampling:m,ySampling:w})}return t.value+=1,l}function pa(e,r){var t=de(e,r),n=de(e,r),s=de(e,r),l=de(e,r),g=de(e,r),h=de(e,r),_=de(e,r),m=de(e,r);return{redX:t,redY:n,greenX:s,greenY:l,blueX:g,blueY:h,whiteX:_,whiteY:m}}function ga(e,r){var t=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],n=ze(e,r);return t[n]}function fa(e,r){var t=fe(e,r),n=fe(e,r),s=fe(e,r),l=fe(e,r);return{xMin:t,yMin:n,xMax:s,yMax:l}}function ma(e,r){var t=["INCREASING_Y"],n=ze(e,r);return t[n]}function _a(e,r){var t=de(e,r),n=de(e,r);return[t,n]}function wa(e,r){var t=de(e,r),n=de(e,r),s=de(e,r);return[t,n,s]}function ya(e,r,t,n,s){if(n==="string"||n==="stringvector"||n==="iccProfile")return la(r,t,s);if(n==="chlist")return da(e,r,t,s);if(n==="chromaticities")return pa(e,t);if(n==="compression")return ga(e,t);if(n==="box2i")return fa(e,t);if(n==="lineOrder")return ma(e,t);if(n==="float")return de(e,t);if(n==="v2f")return _a(e,t);if(n==="v3f")return wa(e,t);if(n==="int")return We(e,t);if(n==="rational")return ca(e,t);if(n==="timecode")return ua(e,t);if(n==="preview")return t.value+=s,"skipped";t.value+=s}function Ea(e,r,t){const n={};if(e.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";n.version=e.getUint8(4);const s=e.getUint8(5);n.spec={singleTile:!!(s&2),longName:!!(s&4),deepFormat:!!(s&8),multiPart:!!(s&16)},t.value=8;for(var l=!0;l;){var g=ar(r,t);if(g==0)l=!1;else{var h=ar(r,t),_=fe(e,t),m=ya(e,r,t,h,_);m===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${h}'.`):n[g]=m}}if(s&-5)throw console.error("EXRHeader:",n),"THREE.EXRLoader: provided file is currently unsupported.";return n}function Sa(e,r,t,n,s){const l={size:0,viewer:r,array:t,offset:n,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[Ke?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":l.lines=1,l.uncompress=Tr;break;case"RLE_COMPRESSION":l.lines=1,l.uncompress=ia;break;case"ZIPS_COMPRESSION":l.lines=1,l.uncompress=cr;break;case"ZIP_COMPRESSION":l.lines=16,l.uncompress=cr;break;case"PIZ_COMPRESSION":l.lines=32,l.uncompress=oa;break;case"PXR24_COMPRESSION":l.lines=16,l.uncompress=sa;break;case"DWAA_COMPRESSION":l.lines=32,l.uncompress=Rr;break;case"DWAB_COMPRESSION":l.lines=256,l.uncompress=Rr;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(l.scanlineBlockSize=l.lines,l.type==1)switch(s){case Ue:l.getter=va,l.inputSize=2;break;case Se:l.getter=$e,l.inputSize=2;break}else if(l.type==2)switch(s){case Ue:l.getter=de,l.inputSize=4;break;case Se:l.getter=ha,l.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+l.type+" for "+e.compression+".";l.blockCount=(e.dataWindow.yMax+1)/l.scanlineBlockSize;for(var g=0;g<l.blockCount;g++)_e(r,n);l.outputChannels=l.channels==3?4:l.channels;const h=l.width*l.height*l.outputChannels;switch(s){case Ue:l.byteArray=new Float32Array(h),l.channels<l.outputChannels&&l.byteArray.fill(1,0,h);break;case Se:l.byteArray=new Uint16Array(h),l.channels<l.outputChannels&&l.byteArray.fill(15360,0,h);break;default:console.error("THREE.EXRLoader: unsupported type: ",s);break}return l.bytesPerLine=l.width*l.inputSize*l.channels,l.outputChannels==4?l.format=je:l.format=Aa,Ke?l.colorSpace="srgb-linear":l.encoding=3e3,l}const tr=new DataView(a),Ma=new Uint8Array(a),Xe={value:0},Ye=Ea(tr,a,Xe),k=Sa(Ye,tr,Ma,Xe,this.type),Ar={value:0},Ia={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<k.height/k.scanlineBlockSize;e++){const r=fe(tr,Xe);k.size=fe(tr,Xe),k.lines=r+k.scanlineBlockSize>k.height?k.height-r:k.scanlineBlockSize;const n=k.size<k.lines*k.bytesPerLine?k.uncompress(k):Tr(k);Xe.value+=k.size;for(let s=0;s<k.scanlineBlockSize;s++){const l=s+e*k.scanlineBlockSize;if(l>=k.height)break;for(let g=0;g<k.channels;g++){const h=Ia[Ye.channels[g].name];for(let _=0;_<k.width;_++){Ar.value=(s*(k.channels*k.width)+g*k.width+_)*k.inputSize;const m=(k.height-1-l)*(k.width*k.outputChannels)+_*k.outputChannels+h;k.byteArray[m]=k.getter(n,Ar)}}}}return{header:Ye,width:k.width,height:k.height,data:k.byteArray,format:k.format,[Ke?"colorSpace":"encoding"]:k[Ke?"colorSpace":"encoding"],type:this.type}}setDataType(a){return this.type=a,this}load(a,o,c,u){function d(v,E){Ke?v.colorSpace=E.colorSpace:v.encoding=E.encoding,v.minFilter=Ce,v.magFilter=Ce,v.generateMipmaps=!1,v.flipY=!1,o&&o(v,E)}return super.load(a,d,c,u)}}const dt=3e3,pt=3001,Zr=(i,a,o)=>{let c;switch(i){case pr:c=new Uint8ClampedArray(a*o*4);break;case Se:c=new Uint16Array(a*o*4);break;case Ba:c=new Uint32Array(a*o*4);break;case Da:c=new Int8Array(a*o*4);break;case Oa:c=new Int16Array(a*o*4);break;case Na:c=new Int32Array(a*o*4);break;case Ue:c=new Float32Array(a*o*4);break;default:throw new Error("Unsupported data type")}return c};let ir;const gt=(i,a,o,c)=>{if(ir!==void 0)return ir;const u=new Br(1,1,c);a.setRenderTarget(u);const d=new mr(new Dr,new ka({color:16777215}));a.render(d,o),a.setRenderTarget(null);const v=Zr(i,u.width,u.height);return a.readRenderTargetPixels(u,0,0,u.width,u.height,v),u.dispose(),d.geometry.dispose(),d.material.dispose(),ir=v[0]!==0,ir};class wr{constructor(a){var o,c,u,d,v,E,p,y,I,C,T,L,D,X,x,B;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(se){throw this._renderer.setRenderTarget(null),se}this._renderer.setRenderTarget(null)},this._width=a.width,this._height=a.height,this._type=a.type,this._colorSpace=a.colorSpace;const ue={format:je,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((o=a.renderTargetOptions)===null||o===void 0?void 0:o.anisotropy)!==void 0?(c=a.renderTargetOptions)===null||c===void 0?void 0:c.anisotropy:1,generateMipmaps:((u=a.renderTargetOptions)===null||u===void 0?void 0:u.generateMipmaps)!==void 0?(d=a.renderTargetOptions)===null||d===void 0?void 0:d.generateMipmaps:!1,magFilter:((v=a.renderTargetOptions)===null||v===void 0?void 0:v.magFilter)!==void 0?(E=a.renderTargetOptions)===null||E===void 0?void 0:E.magFilter:Ce,minFilter:((p=a.renderTargetOptions)===null||p===void 0?void 0:p.minFilter)!==void 0?(y=a.renderTargetOptions)===null||y===void 0?void 0:y.minFilter:Ce,samples:((I=a.renderTargetOptions)===null||I===void 0?void 0:I.samples)!==void 0?(C=a.renderTargetOptions)===null||C===void 0?void 0:C.samples:void 0,wrapS:((T=a.renderTargetOptions)===null||T===void 0?void 0:T.wrapS)!==void 0?(L=a.renderTargetOptions)===null||L===void 0?void 0:L.wrapS:Be,wrapT:((D=a.renderTargetOptions)===null||D===void 0?void 0:D.wrapT)!==void 0?(X=a.renderTargetOptions)===null||X===void 0?void 0:X.wrapT:Be};if(this._material=a.material,a.renderer?this._renderer=a.renderer:(this._renderer=wr.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Or,this._camera=new Fa,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!gt(this._type,this._renderer,this._camera,ue)){let se;switch(this._type){case Se:se=this._renderer.extensions.has("EXT_color_buffer_float")?Ue:void 0;break}se!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ue}`),this._type=se):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new mr(new Dr,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Br(this.width,this.height,ue),this._renderTarget.texture.mapping=((x=a.renderTargetOptions)===null||x===void 0?void 0:x.mapping)!==void 0?(B=a.renderTargetOptions)===null||B===void 0?void 0:B.mapping:lr}static instantiateRenderer(){const a=new xa;return a.setSize(128,128),a}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const a=Zr(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,a),a}toDataTexture(a){const o=new Ua(this.toArray(),this.width,this.height,je,this._type,(a==null?void 0:a.mapping)||lr,(a==null?void 0:a.wrapS)||Be,(a==null?void 0:a.wrapT)||Be,(a==null?void 0:a.magFilter)||Ce,(a==null?void 0:a.minFilter)||Ce,(a==null?void 0:a.anisotropy)||1,dr);return o.generateMipmaps=(a==null?void 0:a.generateMipmaps)!==void 0?a==null?void 0:a.generateMipmaps:!1,o}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(a){this.disposeOnDemandRenderer(),a&&this.renderTarget.dispose(),this.material instanceof _r&&Object.values(this.material.uniforms).forEach(o=>{o.value instanceof Pe&&o.value.dispose()}),Object.values(this.material).forEach(o=>{o instanceof Pe&&o.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(a){this._width=a,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(a){this._height=a,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(a){this._renderTarget=a,this._width=a.width,this._height=a.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const ft=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,mt=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class _t extends _r{constructor({gamma:a,offsetHdr:o,offsetSdr:c,gainMapMin:u,gainMapMax:d,maxDisplayBoost:v,hdrCapacityMin:E,hdrCapacityMax:p,sdr:y,gainMap:I}){super({name:"GainMapDecoderMaterial",vertexShader:ft,fragmentShader:mt,uniforms:{sdr:{value:y},gainMap:{value:I},gamma:{value:new qe(1/a[0],1/a[1],1/a[2])},offsetHdr:{value:new qe().fromArray(o)},offsetSdr:{value:new qe().fromArray(c)},gainMapMin:{value:new qe().fromArray(u)},gainMapMax:{value:new qe().fromArray(d)},weightFactor:{value:(Math.log2(v)-E)/(p-E)}},blending:za,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=v,this._hdrCapacityMin=E,this._hdrCapacityMax=p,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(a){this.uniforms.sdr.value=a}get gainMap(){return this.uniforms.gainMap.value}set gainMap(a){this.uniforms.gainMap.value=a}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(a){this.uniforms.offsetHdr.value.fromArray(a)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(a){this.uniforms.offsetSdr.value.fromArray(a)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(a){this.uniforms.gainMapMin.value.fromArray(a)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(a){this.uniforms.gainMapMax.value.fromArray(a)}get gamma(){const a=this.uniforms.gamma.value;return[1/a.x,1/a.y,1/a.z]}set gamma(a){const o=this.uniforms.gamma.value;o.x=1/a[0],o.y=1/a[1],o.z=1/a[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(a){this._hdrCapacityMin=a,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(a){this._hdrCapacityMax=a,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(a){this._maxDisplayBoost=Math.max(1,Math.min(65504,a)),this.calculateWeight()}calculateWeight(){const a=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,a))}}class Wr extends Error{}class $r extends Error{}const Je=(i,a,o)=>{var c;let u;const d=(c=i.attributes.getNamedItem(a))===null||c===void 0?void 0:c.nodeValue;if(d)u=d;else{const v=i.getElementsByTagName(a)[0];if(v){const E=v.getElementsByTagName("rdf:li");if(E.length===3)u=Array.from(E).map(p=>p.innerHTML);else throw new Error(`Gainmap metadata contains an array of items for ${a} but its length is not 3`)}else{if(o)return o;throw new Error(`Can't find ${a} in gainmap metadata`)}}return u},wt=i=>{var a,o;let c;typeof TextDecoder<"u"?c=new TextDecoder().decode(i):c=i.toString();let u=c.indexOf("<x:xmpmeta");const d=new DOMParser;for(;u!==-1;){const v=c.indexOf("x:xmpmeta>",u);c.slice(u,v+10);const E=c.slice(u,v+10);try{const y=d.parseFromString(E,"text/xml").getElementsByTagName("rdf:Description")[0],I=Je(y,"hdrgm:GainMapMin","0"),C=Je(y,"hdrgm:GainMapMax"),T=Je(y,"hdrgm:Gamma","1"),L=Je(y,"hdrgm:OffsetSDR","0.015625"),D=Je(y,"hdrgm:OffsetHDR","0.015625");let X=(a=y.attributes.getNamedItem("hdrgm:HDRCapacityMin"))===null||a===void 0?void 0:a.nodeValue;X||(X="0");const x=(o=y.attributes.getNamedItem("hdrgm:HDRCapacityMax"))===null||o===void 0?void 0:o.nodeValue;if(!x)throw new Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(I)?I.map(B=>parseFloat(B)):[parseFloat(I),parseFloat(I),parseFloat(I)],gainMapMax:Array.isArray(C)?C.map(B=>parseFloat(B)):[parseFloat(C),parseFloat(C),parseFloat(C)],gamma:Array.isArray(T)?T.map(B=>parseFloat(B)):[parseFloat(T),parseFloat(T),parseFloat(T)],offsetSdr:Array.isArray(L)?L.map(B=>parseFloat(B)):[parseFloat(L),parseFloat(L),parseFloat(L)],offsetHdr:Array.isArray(D)?D.map(B=>parseFloat(B)):[parseFloat(D),parseFloat(D),parseFloat(D)],hdrCapacityMin:parseFloat(X),hdrCapacityMax:parseFloat(x)}}catch{}u=c.indexOf("<x:xmpmeta",v)}};class yt{constructor(a){this.options={debug:a&&a.debug!==void 0?a.debug:!1,extractFII:a&&a.extractFII!==void 0?a.extractFII:!0,extractNonFII:a&&a.extractNonFII!==void 0?a.extractNonFII:!0}}extract(a){return new Promise((o,c)=>{const u=this.options.debug,d=new DataView(a.buffer);if(d.getUint16(0)!==65496){c(new Error("Not a valid jpeg"));return}const v=d.byteLength;let E=2,p=0,y;for(;E<v;){if(++p>250){c(new Error(`Found no marker after ${p} loops ðŸ˜µ`));return}if(d.getUint8(E)!==255){c(new Error(`Not a valid marker at offset 0x${E.toString(16)}, found: 0x${d.getUint8(E).toString(16)}`));return}if(y=d.getUint8(E+1),u&&console.log(`Marker: ${y.toString(16)}`),y===226){u&&console.log("Found APP2 marker (0xffe2)");const I=E+4;if(d.getUint32(I)===1297106432){const C=I+4;let T;if(d.getUint16(C)===18761)T=!1;else if(d.getUint16(C)===19789)T=!0;else{c(new Error("No valid endianness marker found in TIFF header"));return}if(d.getUint16(C+2,!T)!==42){c(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const L=d.getUint32(C+4,!T);if(L<8){c(new Error("Not valid TIFF data! (First offset less than 8)"));return}const D=C+L,X=d.getUint16(D,!T),x=D+2;let B=0;for(let G=x;G<x+12*X;G+=12)d.getUint16(G,!T)===45057&&(B=d.getUint32(G+8,!T));const se=D+2+X*12+4,le=[];for(let G=se;G<se+B*16;G+=16){const H={MPType:d.getUint32(G,!T),size:d.getUint32(G+4,!T),dataOffset:d.getUint32(G+8,!T),dependantImages:d.getUint32(G+12,!T),start:-1,end:-1,isFII:!1};H.dataOffset?(H.start=C+H.dataOffset,H.isFII=!1):(H.start=0,H.isFII=!0),H.end=H.start+H.size,le.push(H)}if(this.options.extractNonFII&&le.length){const G=new Blob([d]),H=[];for(const re of le){if(re.isFII&&!this.options.extractFII)continue;const S=G.slice(re.start,re.end+1,"image/jpeg");H.push(S)}o(H)}}}E+=2+d.getUint16(E+2)}})}}const Et=async i=>{const a=wt(i);if(!a)throw new $r("Gain map XMP metadata not found");const c=await new yt({extractFII:!0,extractNonFII:!0}).extract(i);if(c.length!==2)throw new Wr("Gain map recovery image not found");return{sdr:new Uint8Array(await c[0].arrayBuffer()),gainMap:new Uint8Array(await c[1].arrayBuffer()),metadata:a}},Ur=i=>new Promise((a,o)=>{const c=document.createElement("img");c.onload=()=>{a(c)},c.onerror=u=>{o(u)},c.src=URL.createObjectURL(i)});class Xr extends La{constructor(a,o){super(o),a&&(this._renderer=a),this._internalLoadingManager=new Ha}setRenderer(a){return this._renderer=a,this}setRenderTargetOptions(a){return this._renderTargetOptions=a,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const a=new _t({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Pe,sdr:new Pe});return new wr({width:16,height:16,type:Se,colorSpace:dr,material:a,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(a,o,c,u){const d=u?new Blob([u],{type:"image/jpeg"}):void 0,v=new Blob([c],{type:"image/jpeg"});let E,p,y=!1;if(typeof createImageBitmap>"u"){const T=await Promise.all([d?Ur(d):Promise.resolve(void 0),Ur(v)]);p=T[0],E=T[1],y=!0}else{const T=await Promise.all([d?createImageBitmap(d,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(v,{imageOrientation:"flipY"})]);p=T[0],E=T[1]}const I=new Pe(p||new ImageData(2,2),lr,Be,Be,Ce,Fr,je,pr,1,dr);I.flipY=y,I.needsUpdate=!0;const C=new Pe(E,lr,Be,Be,Ce,Fr,je,pr,1,Pa);C.flipY=y,C.needsUpdate=!0,a.width=E.width,a.height=E.height,a.material.gainMap=I,a.material.sdr=C,a.material.gainMapMin=o.gainMapMin,a.material.gainMapMax=o.gainMapMax,a.material.offsetHdr=o.offsetHdr,a.material.offsetSdr=o.offsetSdr,a.material.gamma=o.gamma,a.material.hdrCapacityMin=o.hdrCapacityMin,a.material.hdrCapacityMax=o.hdrCapacityMax,a.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),a.material.needsUpdate=!0,a.render()}}class St extends Xr{load([a,o,c],u,d,v){const E=this.prepareQuadRenderer();let p,y,I;const C=async()=>{if(p&&y&&I){try{await this.render(E,I,p,y)}catch(b){this.manager.itemError(a),this.manager.itemError(o),this.manager.itemError(c),typeof v=="function"&&v(b),E.disposeOnDemandRenderer();return}typeof u=="function"&&u(E),this.manager.itemEnd(a),this.manager.itemEnd(o),this.manager.itemEnd(c),E.disposeOnDemandRenderer()}};let T=!0,L=0,D=0,X=!0,x=0,B=0,ue=!0,se=0,le=0;const G=()=>{if(typeof d=="function"){const b=L+x+se,z=D+B+le,$=T&&X&&ue;d(new ProgressEvent("progress",{lengthComputable:$,loaded:z,total:b}))}};this.manager.itemStart(a),this.manager.itemStart(o),this.manager.itemStart(c);const H=new sr(this._internalLoadingManager);H.setResponseType("arraybuffer"),H.setRequestHeader(this.requestHeader),H.setPath(this.path),H.setWithCredentials(this.withCredentials),H.load(a,async b=>{if(typeof b=="string")throw new Error("Invalid sdr buffer");p=b,await C()},b=>{T=b.lengthComputable,D=b.loaded,L=b.total,G()},b=>{this.manager.itemError(a),typeof v=="function"&&v(b)});const re=new sr(this._internalLoadingManager);re.setResponseType("arraybuffer"),re.setRequestHeader(this.requestHeader),re.setPath(this.path),re.setWithCredentials(this.withCredentials),re.load(o,async b=>{if(typeof b=="string")throw new Error("Invalid gainmap buffer");y=b,await C()},b=>{X=b.lengthComputable,B=b.loaded,x=b.total,G()},b=>{this.manager.itemError(o),typeof v=="function"&&v(b)});const S=new sr(this._internalLoadingManager);return S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(c,async b=>{if(typeof b!="string")throw new Error("Invalid metadata string");I=JSON.parse(b),await C()},b=>{ue=b.lengthComputable,le=b.loaded,se=b.total,G()},b=>{this.manager.itemError(c),typeof v=="function"&&v(b)}),E}}class Mt extends Xr{load(a,o,c,u){const d=this.prepareQuadRenderer(),v=new sr(this._internalLoadingManager);return v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(this.withCredentials),this.manager.itemStart(a),v.load(a,async E=>{if(typeof E=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const p=new Uint8Array(E);let y,I,C;try{const T=await Et(p);y=T.sdr,I=T.gainMap,C=T.metadata}catch(T){if(T instanceof $r||T instanceof Wr)console.warn(`Failure to reconstruct an HDR image from ${a}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),C={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},y=p;else throw T}try{await this.render(d,C,y,I)}catch(T){this.manager.itemError(a),typeof u=="function"&&u(T),d.disposeOnDemandRenderer();return}typeof o=="function"&&o(d),this.manager.itemEnd(a),d.disposeOnDemandRenderer()},c,E=>{this.manager.itemError(a),typeof u=="function"&&u(E)}),d}}const vr={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},It="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",or=i=>Array.isArray(i);function Yr({files:i=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:a="",preset:o=void 0,encoding:c=void 0,extensions:u}={}){var d;let v=null,E=!1,p;if(o){if(!(o in vr))throw new Error("Preset must be one of: "+Object.keys(vr).join(", "));i=vr[o],a=It}const y=or(i)&&i.length===6,I=or(i)&&i.length===3&&i.some(x=>x.endsWith("json")),C=or(i)?i[0]:i;if(E=or(i),p=y?"cube":I?"webp":C.startsWith("data:application/exr")?"exr":C.startsWith("data:application/hdr")?"hdr":C.startsWith("data:image/jpeg")?"jpg":(d=C.split(".").pop())==null||(d=d.split("?"))==null||(d=d.shift())==null?void 0:d.toLowerCase(),v=p==="cube"?$a:p==="hdr"?ht:p==="exr"?vt:p==="jpg"||p==="jpeg"?Mt:p==="webp"?St:null,!v)throw new Error("useEnvironment: Unrecognized file extension: "+i);const T=er(x=>x.gl),L=Ga(v,E?[i]:i,x=>{(p==="webp"||p==="jpg"||p==="jpeg")&&x.setRenderer(T),x.setPath==null||x.setPath(a),u&&u(x)});let D=E?L[0]:L;if(p==="jpg"||p==="jpeg"||p==="webp"){var X;D=(X=D.renderTarget)==null?void 0:X.texture}return D.mapping=y?Za:Wa,"colorSpace"in D?D.colorSpace=c??y?"srgb":"srgb-linear":D.encoding=c??y?pt:dt,D}const bt=i=>i.current&&i.current.isScene,Tt=i=>bt(i)?i.current:i;function yr(i,a,o,c,u={}){var d,v,E,p,y;u={backgroundBlurriness:(d=u.blur)!==null&&d!==void 0?d:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...u};const I=Tt(a||o),C=I.background,T=I.environment,L={backgroundBlurriness:I.backgroundBlurriness,backgroundIntensity:I.backgroundIntensity,backgroundRotation:(v=(E=I.backgroundRotation)==null||E.clone==null?void 0:E.clone())!==null&&v!==void 0?v:[0,0,0],environmentIntensity:I.environmentIntensity,environmentRotation:(p=(y=I.environmentRotation)==null||y.clone==null?void 0:y.clone())!==null&&p!==void 0?p:[0,0,0]};return i!=="only"&&(I.environment=c),i&&(I.background=c),xr(I,u),()=>{i!=="only"&&(I.environment=T),i&&(I.background=C),xr(I,L)}}function Er({scene:i,background:a=!1,map:o,...c}){const u=er(d=>d.scene);return oe.useLayoutEffect(()=>{if(o)return yr(a,i,u,o,c)}),null}function Vr({background:i=!1,scene:a,blur:o,backgroundBlurriness:c,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:v,environmentRotation:E,...p}){const y=Yr(p),I=er(C=>C.scene);return oe.useLayoutEffect(()=>yr(i,a,I,y,{blur:o,backgroundBlurriness:c,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:v,environmentRotation:E})),null}function Rt({children:i,near:a=1,far:o=1e3,resolution:c=256,frames:u=1,map:d,background:v=!1,blur:E,backgroundBlurriness:p,backgroundIntensity:y,backgroundRotation:I,environmentIntensity:C,environmentRotation:T,scene:L,files:D,path:X,preset:x=void 0,extensions:B}){const ue=er(S=>S.gl),se=er(S=>S.scene),le=oe.useRef(null),[G]=oe.useState(()=>new Or),H=oe.useMemo(()=>{const S=new Xa(c);return S.texture.type=Se,S},[c]);oe.useLayoutEffect(()=>(u===1&&le.current.update(ue,G),yr(v,L,se,H.texture,{blur:E,backgroundBlurriness:p,backgroundIntensity:y,backgroundRotation:I,environmentIntensity:C,environmentRotation:T})),[i,G,H.texture,L,se,v,u,ue]);let re=1;return Ya(()=>{(u===1/0||re<u)&&(le.current.update(ue,G),re++)}),oe.createElement(oe.Fragment,null,Va(oe.createElement(oe.Fragment,null,i,oe.createElement("cubeCamera",{ref:le,args:[a,o,H]}),D||x?oe.createElement(Vr,{background:!0,files:D,preset:x,path:X,extensions:B}):d?oe.createElement(Er,{background:!0,map:d,extensions:B}):null),G))}function Ct(i){var a,o,c,u;const d=Yr(i),v=i.map||d;oe.useMemo(()=>qa({GroundProjectedEnvImpl:ut}),[]);const E=oe.useMemo(()=>[v],[v]),p=(a=i.ground)==null?void 0:a.height,y=(o=i.ground)==null?void 0:o.radius,I=(c=(u=i.ground)==null?void 0:u.scale)!==null&&c!==void 0?c:1e3;return oe.createElement(oe.Fragment,null,oe.createElement(Er,ba({},i,{map:v})),oe.createElement("groundProjectedEnvImpl",{args:E,scale:I,height:p,radius:y}))}function xt(i){return i.ground?oe.createElement(Ct,i):i.map?oe.createElement(Er,i):i.children?oe.createElement(Rt,i):oe.createElement(Vr,i)}export{xt as E};
